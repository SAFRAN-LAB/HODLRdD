\doxysection{stream.\+h}
\hypertarget{stream_8h_source}{}\label{stream_8h_source}\index{lib/cereal/external/rapidjson/stream.h@{lib/cereal/external/rapidjson/stream.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Tencent\ is\ pleased\ to\ support\ the\ open\ source\ community\ by\ making\ RapidJSON\ available.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (C)\ 2015\ THL\ A29\ Limited,\ a\ Tencent\ company,\ and\ Milo\ Yip.\ All\ rights\ reserved.}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Licensed\ under\ the\ MIT\ License\ (the\ "{}License"{});\ you\ may\ not\ use\ this\ file\ except}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ in\ compliance\ with\ the\ License.\ You\ may\ obtain\ a\ copy\ of\ the\ License\ at}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ http://opensource.org/licenses/MIT}}
\DoxyCodeLine{00009\ \textcolor{comment}{//}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ Unless\ required\ by\ applicable\ law\ or\ agreed\ to\ in\ writing,\ software\ distributed}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ under\ the\ License\ is\ distributed\ on\ an\ "{}AS\ IS"{}\ BASIS,\ WITHOUT\ WARRANTIES\ OR}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ CONDITIONS\ OF\ ANY\ KIND,\ either\ express\ or\ implied.\ See\ the\ License\ for\ the}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ specific\ language\ governing\ permissions\ and\ limitations\ under\ the\ License.}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{rapidjson_8h}{rapidjson.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#ifndef\ CEREAL\_RAPIDJSON\_STREAM\_H\_}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#define\ CEREAL\_RAPIDJSON\_STREAM\_H\_}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}encodings.h"{}}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_ga69bf61966c74b09b5d90b386847f39be}{CEREAL\_RAPIDJSON\_NAMESPACE\_BEGIN}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00025\ \textcolor{comment}{//\ \ Stream}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00039\ \ \ \ \ Ch\ Peek()\ const;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00042\ \ \ \ \ Ch\ Take();}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00046\ \ \ \ \ size\_t\ Tell();}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00050\ \ \ \ \ Ch*\ PutBegin();}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00053\ \ \ \ \ void\ Put(Ch\ c);}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00056\ \ \ \ \ void\ Flush();}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00061\ \ \ \ \ size\_t\ PutEnd(Ch*\ begin);}
\DoxyCodeLine{00062\ \}}
\DoxyCodeLine{00063\ \(\backslash\)endcode}
\DoxyCodeLine{00064\ */}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00072\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Stream>}
\DoxyCodeLine{00073\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_stream_traits}{StreamTraits}}\ \{}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keyword}{enum}\ \{\ copyOptimization\ =\ 0\ \};}
\DoxyCodeLine{00080\ \};}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00083\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Stream>}
\DoxyCodeLine{00084\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ PutReserve(\mbox{\hyperlink{classrapidjson_1_1_stream}{Stream}}\&\ stream,\ \textcolor{keywordtype}{size\_t}\ count)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ (void)stream;}
\DoxyCodeLine{00086\ \ \ \ \ (void)count;}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00090\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Stream>}
\DoxyCodeLine{00091\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ PutUnsafe(\mbox{\hyperlink{classrapidjson_1_1_stream}{Stream}}\&\ stream,\ \textcolor{keyword}{typename}\ Stream::Ch\ c)\ \{}
\DoxyCodeLine{00092\ \ \ \ \ stream.Put(c);}
\DoxyCodeLine{00093\ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00096\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Stream,\ \textcolor{keyword}{typename}\ Ch>}
\DoxyCodeLine{00097\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ PutN(\mbox{\hyperlink{classrapidjson_1_1_stream}{Stream}}\&\ stream,\ Ch\ c,\ \textcolor{keywordtype}{size\_t}\ n)\ \{}
\DoxyCodeLine{00098\ \ \ \ \ PutReserve(stream,\ n);}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ n;\ i++)}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ PutUnsafe(stream,\ c);}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00104\ \textcolor{comment}{//\ GenericStreamWrapper}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)\ \&\&\ \_MSC\_VER\ <=\ 1800}}
\DoxyCodeLine{00113\ CEREAL\_RAPIDJSON\_DIAG\_PUSH}
\DoxyCodeLine{00114\ CEREAL\_RAPIDJSON\_DIAG\_OFF(4702)\ \ \textcolor{comment}{//\ unreachable\ code}}
\DoxyCodeLine{00115\ CEREAL\_RAPIDJSON\_DIAG\_OFF(4512)\ \ \textcolor{comment}{//\ assignment\ operator\ could\ not\ be\ generated}}
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ InputStream,\ \textcolor{keyword}{typename}\ Encoding\ =\ UTF8<>\ >}
\DoxyCodeLine{00119\ \textcolor{keyword}{class\ }GenericStreamWrapper\ \{}
\DoxyCodeLine{00120\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Encoding::Ch\ Ch;}
\DoxyCodeLine{00122\ \ \ \ \ GenericStreamWrapper(InputStream\&\ is):\ is\_(is)\ \{\}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ Ch\ Peek()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ is\_.Peek();\ \}}
\DoxyCodeLine{00125\ \ \ \ \ Ch\ Take()\ \{\ \textcolor{keywordflow}{return}\ is\_.Take();\ \}}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ Tell()\ \{\ \textcolor{keywordflow}{return}\ is\_.Tell();\ \}}
\DoxyCodeLine{00127\ \ \ \ \ Ch*\ PutBegin()\ \{\ \textcolor{keywordflow}{return}\ is\_.PutBegin();\ \}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordtype}{void}\ Put(Ch\ ch)\ \{\ is\_.Put(ch);\ \}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordtype}{void}\ Flush()\ \{\ is\_.Flush();\ \}}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ PutEnd(Ch*\ ch)\ \{\ \textcolor{keywordflow}{return}\ is\_.PutEnd(ch);\ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ wrapper\ for\ MemoryStream}}
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keyword}{const}\ Ch*\ Peek4()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ is\_.Peek4();\ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ wrapper\ for\ AutoUTFInputStream}}
\DoxyCodeLine{00136\ \ \ \ \ UTFType\ GetType()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ is\_.GetType();\ \}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordtype}{bool}\ HasBOM()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ is\_.HasBOM();\ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00140\ \ \ \ \ InputStream\&\ is\_;}
\DoxyCodeLine{00141\ \};}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)\ \&\&\ \_MSC\_VER\ <=\ 1800}}
\DoxyCodeLine{00144\ CEREAL\_RAPIDJSON\_DIAG\_POP}
\DoxyCodeLine{00145\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00148\ \textcolor{comment}{//\ StringStream}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00153\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Encoding>}
\DoxyCodeLine{00154\ \textcolor{keyword}{struct\ }GenericStringStream\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Encoding::Ch\ Ch;}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ GenericStringStream(\textcolor{keyword}{const}\ Ch\ *src)\ :\ \mbox{\hyperlink{struct_generic_string_stream_aeda813798e3f2d6bfdac86afc11b6b80}{src\_}}(src),\ \mbox{\hyperlink{struct_generic_string_stream_a3c86ef1e1f0655028cb8a3afce11ee4f}{head\_}}(src)\ \{\}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ Ch\ Peek()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ *\mbox{\hyperlink{struct_generic_string_stream_aeda813798e3f2d6bfdac86afc11b6b80}{src\_}};\ \}}
\DoxyCodeLine{00160\ \ \ \ \ Ch\ Take()\ \{\ \textcolor{keywordflow}{return}\ *\mbox{\hyperlink{struct_generic_string_stream_aeda813798e3f2d6bfdac86afc11b6b80}{src\_}}++;\ \}}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ Tell()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(\mbox{\hyperlink{struct_generic_string_stream_aeda813798e3f2d6bfdac86afc11b6b80}{src\_}}\ -\/\ \mbox{\hyperlink{struct_generic_string_stream_a3c86ef1e1f0655028cb8a3afce11ee4f}{head\_}});\ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ Ch*\ PutBegin()\ \{\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_ga06f04b87f6adff794a5a4bbe254dc15c}{CEREAL\_RAPIDJSON\_ASSERT}}(\textcolor{keyword}{false});\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordtype}{void}\ Put(Ch)\ \{\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_ga06f04b87f6adff794a5a4bbe254dc15c}{CEREAL\_RAPIDJSON\_ASSERT}}(\textcolor{keyword}{false});\ \}}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordtype}{void}\ Flush()\ \{\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_ga06f04b87f6adff794a5a4bbe254dc15c}{CEREAL\_RAPIDJSON\_ASSERT}}(\textcolor{keyword}{false});\ \}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ PutEnd(Ch*)\ \{\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_ga06f04b87f6adff794a5a4bbe254dc15c}{CEREAL\_RAPIDJSON\_ASSERT}}(\textcolor{keyword}{false});\ \textcolor{keywordflow}{return}\ 0;\ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{const}\ Ch*\ \mbox{\hyperlink{struct_generic_string_stream_aeda813798e3f2d6bfdac86afc11b6b80}{src\_}};\ \ \ \ \ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keyword}{const}\ Ch*\ \mbox{\hyperlink{struct_generic_string_stream_a3c86ef1e1f0655028cb8a3afce11ee4f}{head\_}};\ \ \ \ }
\DoxyCodeLine{00170\ \};}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Encoding>}
\DoxyCodeLine{00173\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_stream_traits}{StreamTraits}}<\mbox{\hyperlink{struct_generic_string_stream}{GenericStringStream}}<\mbox{\hyperlink{classrapidjson_1_1_encoding}{Encoding}}>\ >\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keyword}{enum}\ \{\ copyOptimization\ =\ 1\ \};}
\DoxyCodeLine{00175\ \};}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00178\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_generic_string_stream}{GenericStringStream<UTF8<>}}\ >\ StringStream;}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00181\ \textcolor{comment}{//\ InsituStringStream}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00187\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Encoding>}
\DoxyCodeLine{00188\ \textcolor{keyword}{struct\ }GenericInsituStringStream\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Encoding::Ch\ Ch;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ GenericInsituStringStream(Ch\ *src)\ :\ src\_(src),\ dst\_(0),\ head\_(src)\ \{\}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//\ Read}}
\DoxyCodeLine{00194\ \ \ \ \ Ch\ Peek()\ \{\ \textcolor{keywordflow}{return}\ *src\_;\ \}}
\DoxyCodeLine{00195\ \ \ \ \ Ch\ Take()\ \{\ \textcolor{keywordflow}{return}\ *src\_++;\ \}}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ Tell()\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(src\_\ -\/\ head\_);\ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{comment}{//\ Write}}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordtype}{void}\ Put(Ch\ c)\ \{\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_ga06f04b87f6adff794a5a4bbe254dc15c}{CEREAL\_RAPIDJSON\_ASSERT}}(dst\_\ !=\ 0);\ *dst\_++\ =\ c;\ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ Ch*\ PutBegin()\ \{\ \textcolor{keywordflow}{return}\ dst\_\ =\ src\_;\ \}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ PutEnd(Ch*\ begin)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(dst\_\ -\/\ begin);\ \}}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{void}\ Flush()\ \{\}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ Ch*\ Push(\textcolor{keywordtype}{size\_t}\ count)\ \{\ Ch*\ begin\ =\ dst\_;\ dst\_\ +=\ count;\ \textcolor{keywordflow}{return}\ begin;\ \}}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{void}\ Pop(\textcolor{keywordtype}{size\_t}\ count)\ \{\ dst\_\ -\/=\ count;\ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ Ch*\ src\_;}
\DoxyCodeLine{00209\ \ \ \ \ Ch*\ dst\_;}
\DoxyCodeLine{00210\ \ \ \ \ Ch*\ head\_;}
\DoxyCodeLine{00211\ \};}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Encoding>}
\DoxyCodeLine{00214\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_stream_traits}{StreamTraits}}<\mbox{\hyperlink{struct_generic_insitu_string_stream}{GenericInsituStringStream}}<\mbox{\hyperlink{classrapidjson_1_1_encoding}{Encoding}}>\ >\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keyword}{enum}\ \{\ copyOptimization\ =\ 1\ \};}
\DoxyCodeLine{00216\ \};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00219\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{struct_generic_insitu_string_stream}{GenericInsituStringStream<UTF8<>}}\ >\ InsituStringStream;}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \mbox{\hyperlink{group___c_e_r_e_a_l___r_a_p_i_d_j_s_o_n___c_o_n_f_i_g_gaddb083c1a6a5beaafbecc3f99973a3ff}{CEREAL\_RAPIDJSON\_NAMESPACE\_END}}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ CEREAL\_RAPIDJSON\_STREAM\_H\_}}

\end{DoxyCode}
